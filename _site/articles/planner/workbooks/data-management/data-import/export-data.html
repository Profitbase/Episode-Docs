<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Export data | Profitbase Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Export data | Profitbase Docs ">
      
      <link rel="icon" href="../../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
  </head>

  <script type="module">
    import options from './../../../../../public/main.js'
    import { init } from './../../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h3 id="overview">Overview</h3>

<p>This module is used to export data from Profitbase Planner to external sources, such as CSV files in Azure blob storages or any SQL database made available.
<br></p>
<p>Each export &quot;ruleset&quot; created can either be started manually from the Data Export module, or be used to generate an operation (todo: link to Operation Manager).
<br></p>
<p>The general principle for Data Export jobs is:
<br>
<br>
1 - Select a source within Profitbase Planner.
<br>
2 - Column Mapping must be set up to match the correct columns between the source table or view, and the actual destination table. This step allows for SQL transform formulas.
<br>
3 - Once the column mapping has been set up, the &quot;Execute Now&quot; button will become active. This button will then do execute the export job and move the data using the column mapping rules to the destination table.
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/plannerimages/DataExport.png" alt=""></p>
<br>
<p>Buttons will become active once the required information has been set up.</p>
<br>
<h4 id="creating-a-new-ruleset-for-data-export">Creating a new RuleSet for Data Export</h4>
<br>
Click an existing RuleSet in the list to open it.
<br>
Click the "Add ruleset" button above the list to create a new ruleset.
<br>
Each section for the ruleset will be described below.
<br>
<br>
<h4 id="data-export-ruleset">DATA EXPORT RULESET</h4>
<br>
<b>Ruleset name:</b> A short name for the data import job, so it can easily be identified in the list.
<br>
<b>Data Source:</b> Current options are defined by a Profitbase Planner admin. Typically, these will be Views or Tables accessed via a synonym. A preview button will show up to 200 rows of that data. Click the arrow behind preview, to view the "Create Table Statement": this is useful if you need to create a copy of that table somewhere. For instances hosted by Profitbase, an export to Excel is also available.
<br>
<b>Select Export Name:</b> If the source contains a column called "ExportName" (compound views), selection is mandatory.
<br>
<b>SQL WHERE clause on source: (Optional):</b> Filter the source with custom SQL code. Do not specify the keyword "WHERE", just the conditions.
<br>
<b>Connection:</b> Select a [Connection](/planner/workbooks/data-management/connections) from the list. Changing this field will trigger an automatic save.
A "Test Connection" button is available, and will also be automatically triggered when loading a ruleset with a connection. A "browse" button will be enabled for valid Azure Blob connections, to view the files.
<br>
<h4 id="configure-destination-azure-blob-storage---csv-file-option-1">CONFIGURE DESTINATION: AZURE BLOB STORAGE - CSV FILE (Option 1)</h4>
<br>
<b>File name:</b> The file will be created with that name. If a file exists with the same name, it will be overwritten.
<br>
<b>Column delimiter:</b> The symbol used inside the CSV file to separate the columns. Typical values are either <b>,</b> or <b>;</b>
<br>
<b>Text qualifier:</b> The symbol used inside the CSV file to wrap data strings. Most common is <b>"</b>
<br>
<b>Date Format:</b> Leave as default, or enforce a transform format for all dates and datetimes.
<br>
<br>
<h4 id="configure-destination-direct-sql-option-2">CONFIGURE DESTINATION: DIRECT SQL (Option 2)</h4>
<br>
<b>Destination table:</b> Select from the list of tables on the destination. If the connection fails, this list will be empty.
<br>
<b>Select delete method:</b> Select from the list of options:
<br>
 - Append all: All data will be added to the destination.
 <br>
 - Replace all: All data in the destination will be replaced. "Truncate" will be faster but require elevated permissions.
 <br>
 - Custom SQL: Write the SQL where clause to select what data will be removed from the destination.
 <br>
 - Stored Procedure: Select from the list of stored procedures found on the destination.
<br>
<h4 id="column-mapping">COLUMN MAPPING</h4>
<br>
Mandatory step to perform the copy of data from the SQL temporary table to the final destination.
<br>
This will tell the system which column to put where, as the column names don't necessarily match.
<br>
Here is a basic example:
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/plannerimages/ColumnMappingExample.PNG" alt=""></p>
<br>
EmployeeID will be imported as-is.
<br>
If the Employee name is "Lisa", it will be replaced with "Nico". This can be used to add any logic, and may even reference other columns.
<br>
EmploymentType_Name will be left to NULL for all rows in the destination, regardless of imported data (no string delimiters).
<br>
EmploymentType will be "Programmer" for all rows in the destination, regardless of imported data (note the string delimiters).
<br>
ModifyType and PBRowIdentity will be ignored.
<br>
After the column mapping has been saved, a summary will be displayed in the final section:
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/plannerimages/ColumnMappingExample_result.PNG" alt=""></p>
<br>
Clicking auto-cast, will use any mappings set up, and automatically add a transform formula. If transforms have already been added, they will be wrapped in this additional casting.
<br>
<h4 id="optional-creating-operations-to-automate-data-exports">(Optional) Creating Operations to automate Data Exports</h4>
<p>To run an export job, click the &quot;Execute Now&quot; button.
<br>
This will perform all the steps above, which consists of one step, a dataflow with an argument (the export ruleset GUID).
<br>
If you wish to automate this job or just expose it to the &quot;Operation Manager&quot; module of the Profitbase Planner, the &quot;Create Operation&quot; button will create an operation with the same name as the ruleset, under the application &quot;EPMDataMart&quot; and the category &quot;Data Export&quot;.
<br></p>
<h3 id="related-pages">Related Pages</h3>
<p><a href="import-data.html">Data Import</a>
<a href="../../administration/operation-manager/ScheduledOperations.html">Scheduled Operations</a>
<a href="../../administration/operation-manager/Operations.html">Operations</a></p>
</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>