<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Programmatically Change Global Parameters | InVision </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Programmatically Change Global Parameters | InVision ">
      
      <link rel="icon" href="../../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../">
      
      
      
  </head>

  <script type="module">
    import options from './../../../../../public/main.js'
    import { init } from './../../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">


<p>Sometimes, you need to change the Global Parameters and arguments during execution of a Data Flow. By doing that, you change the global parameters and the arguments within the current execution scope of the Data Flow, meaning all following Data Flow Activities in the current Data Flow and nested Data Flows.
<br></p>
<p><strong>Step 1:</strong> Create a C# script that returns the new arguments to the Global Parameters.</p>
<p>In a Data Flow Item, create a new C# Script under <em>Resource Sets / Local Resource Sets / DefaultResource</em> (if it does not exist, create it). You can name the script whatever you like.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam1.png" alt="pic"></p>
<br>
<p>Next, add a method to the script that returns a <code>Dictionary&lt;string,object&gt;</code>, where the keys are the names of the Global Parameters, and the values are the arguments.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam2.png" alt="pic"></p>
<br>
<p><strong>Step 2:</strong> Add an assembly reference to Profitbase.AppFramework.Infinity.dll (Profitbase Runtime Functions).<br>
This will let you call a function to update the global parameters with the new values that you have produced in Step 1:</p>
<ol>
<li>Select the DefaultResources node in the Explorer,</li>
<li>Choose the Assemblies tab in the Toolbox,</li>
<li>Drag and drop the Profitbase.AppFramework.Infinity.dll into the Resources view.</li>
</ol>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam3.png" alt="pic"></p>
<br>
<p><strong>Step 3:</strong> Update the arguments to the Global Parameters.</p>
<ol>
<li>Select the Tasks folder in the Explorer,</li>
<li>Then, select the Actions tab in the Toolbox,</li>
</ol>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam4.png" alt="pic"></p>
<br>
<ol start="3">
<li>Locate your method (from Step 1) in the Actions Explorer and drag-drop it into the Tasks list. Press the Refresh button at the top of the Actions Explorer if you cannot find it,</li>
</ol>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam5.png" alt="pic"></p>
<br>
<ol start="4">
<li>Select the new task in the Explorer and change the Execution Phase to Phase 1,</li>
</ol>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam6.png" alt="pic"></p>
<br>
<ol start="5">
<li>Select the Tasks folder in the Explorer and pull in the SetGlobalArguments method from the Actions Toolbox. The SetGlobalArguments will completely overwrite the current global arguments. If your method produces only a subset of the new global arguments, use the UpdateGlobalArguments instead. It will overwrite an argument with the same key, and add new arguments, but it will not delete an argument.
The GetGlobalArguments method returns a <code>Dictionary&lt;string,object&gt;</code> which can be passed into your C# script.</li>
</ol>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam7.png" alt="pic"></p>
<br>
<ol start="6">
<li>Select the new task in the Explorer and change the Execution Phase to Phase 1.</li>
</ol>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/glParam8.png" alt="pic"></p>
<br>
<p>The new arguments will be applied to all tasks at the current and descendant levels of the execution tree. They will not be applied to Data Flows higher in the execution tree if Data Flows are nested.</p>
<br>
</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>