<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Pb. (dot-sourcing) | InVision </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Pb. (dot-sourcing) | InVision ">
      
      <link rel="icon" href="../../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../">
      
      
      
  </head>

  <script type="module">
    import options from './../../../../../public/main.js'
    import { init } from './../../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">


<p>PowerShell supports <strong>dot-sourcing</strong>. You can type a dot (<strong>.</strong>) followed by a <strong>space</strong>, followed by a <strong>ps1</strong> file name pointing to a script you want to include in the current script context.</p>
<p><strong>InVision</strong> supports its own dot-sourcing where you can type <strong>Pb.</strong> followed by a <strong>space</strong>, followed by the name of a <strong>PowerShell</strong> or <strong>SQL</strong> script defined in the solution.</p>
<p>This will make code in another script available to you. This is useful if you want to call a function residing in another script.<br>
In SaaS solutions, the Solution Devs will not be able to put a file on any disk. This feature meets the need to dot-source a script without requiring access to disk.</p>
<p><strong>Note</strong><br>
If a PowerShell Script and a SQL Script have the same name, you can specify the type after the comma (i.e. Pb. ‘MyScript, SQL’ or ‘MyScript, Pwsh’). Hence comma is not an allowed character in the names of scripts that are to be referred via Pb.
<br>
<br></p>
<p><strong>Example 1</strong></p>
<p><strong>Embed PowerShell Script</strong></p>
<p>We need to import data from several Excel worksheets, so We create a PowerShell script that implements a generic import of Excel data.<br>
We call this script <code>Excel Impl</code>. It has functions that do the work of bulk copying Excel Worksheet data into a SQL Server table.</p>
<p>Then we create a script that will be a function library that works as a layer between the implementation and the scripts that are going to use the functions.<br>
We call this script <code>Excel Functions</code>.</p>
<p>Lastly, we create the script that needs to import data from Excel worksheets into SQL server tables.<br>
We call this script <code>Pb. Example Excel</code>.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1a.png" alt="dot-sourcing" title="dot-sourcing"></p>
<br>
<p><code>Excel Impl</code> has the reference to Sql Server.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1b.png" alt="dot-sourcing" title="dot-sourcing"></p>
<br>
<p>It also contains code that will be used by the <code>Excel Functions</code> script.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1c.png" alt="dot-sourcing" title="dot-sourcing"></p>
<br>
<p><code>Excel Functions</code> uses <code>Pb. 'Excel Impl'</code> to enable use of the <code>Import-ExcelData</code> function inside <code>Excel Impl</code></p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1d.png" alt="dot-sourcing" title="dot-sourcing"></p>
<br>
<p>Finally We use <code>Pb. Excel Functions</code> to enable use of the <code>PbImport-Excel</code> function inside the <code>Excel Functions</code>.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1e.png" alt="dot-sourcing" title="dot-sourcing"></p>
<br>
<br>
<p><strong>Example 2</strong></p>
<p><strong>Embed SQL Script</strong></p>
<p>We have a SQL Script called <code>Sql w macro</code>.
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1a2.png" alt="dot-sourcing" title="dot-sourcing">
<br></p>
<p>It has a macro defined.<br>
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1b2.png" alt="dot-sourcing" title="dot-sourcing">
<br></p>
<p>We make a PowerShell script called <code>Test macro</code>.<br>
In this script we add a reference to the NuGet Package <em>Microsoft.Data.SqlClient</em>.<br>
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1c2.png" alt="dot-sourcing" title="dot-sourcing"></p>
<br>
<p>We add the following script where I use <code>Pb. 'Sql w macro'</code> to embed the SQL Script called <code>Sql w macro</code>.
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/function1d2.png" alt="dot-sourcing" title="dot-sourcing"></p>
</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>