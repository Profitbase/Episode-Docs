<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Filter slicing | InVision </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Filter slicing | InVision ">
      
      <link rel="icon" href="../../../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
  </head>

  <script type="module">
    import options from './../../../../../../public/main.js'
    import { init } from './../../../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">


<p>You can slice hierarchical filters, so they only contain items specified in list of leaf level members.</p>
<p>For example, suppose you have a spreadsheet with data relating to departments and products. Users first filter the spreadsheet based on department, but they want to further filter the spreadsheet on products and product groups. They want the Product filter to contain only the product hierarchies for the products in the spreadsheet, not all products in the Product dimension.</p>
<p>To achieve this, you need to call the <strong>SetLeafLevelConstraints(…)</strong> and specify a list of product ids in the Load Data action of the filter.</p>
<br>
<p><strong>Example</strong></p>
<ol>
<li>Create a Workbook variable to store the product ids:</li>
</ol>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/slicingFilter1.png" alt="pic"></p>
<br>
<ol start="2">
<li>Create a JavaScript which returns a list of product ids:</li>
</ol>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/slicingFilter2.png" alt="pic"></p>
<br>
<ol start="3">
<li>In the spreadsheet calculations, call the JavaScript and assign the result to the Workbook variable:</li>
</ol>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/slicingFilter3.png" alt="pic"></p>
<br>
<ol start="4">
<li>In the Load Data action of the (Product) filter, call SetLeafLevelConstraint(…) and pass in the variable.</li>
</ol>
<p><strong>Note that you need to call Load Data on the filter AFTER the spreadsheet has been loaded, or else the list of product ids has not been created.</strong></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/slicingFilter4.png" alt="pic"></p>
<br>
<h3 id="videos">Videos</h3>
<ul>
<li><a href="../../../../videos/workbooks.html">Workbooks</a></li>
</ul>
</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>