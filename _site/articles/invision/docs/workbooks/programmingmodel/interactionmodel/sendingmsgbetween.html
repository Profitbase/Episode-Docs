<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Sending Messages Between Workbooks | InVision </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Sending Messages Between Workbooks | InVision ">
      
      <link rel="icon" href="../../../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../../">
      
      
      
  </head>

  <script type="module">
    import options from './../../../../../../public/main.js'
    import { init } from './../../../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">


<p><a href="../../../workbooks.html">Workbooks</a> can send and receive messages from other Workbooks running on the same website.
Messages are being sent by executing SendMessage Actions by providing the receiver address and the payload by calling the <a href="../instructions/configuremessage.html">ConfigureMessage(…)</a> function.</p>
<p>Messages are received by subscribing to the MessageReceivedEventet of the Workbook.</p>
<ul>
<li><p><strong>Sending a message</strong><br>
A message is sent using the SendMessage action and calling the <a href="../instructions/configuremessage.html">ConfigureMessage(…)</a> function to specify the address and payload. For details, see the topic of Creating and sending a message object.</p>
</li>
<li><p><strong>Receiving a message</strong><br>
Messages are received by subscribing to the MessageReceivedEventet of the Workbook. When the event is raised, you can access the message object through the @Event.Data property.
The @Event.Data variable will contain the MessageCode, Message, and Data that was sent. You can use the message data in conditions and instructions after the message is received.</p>
</li>
</ul>
<blockquote>
<p><strong>Example</strong></p>
<p>This example shows how to store the Message and Data values from a received message in two variables by calling the Execute Expression action when a message is received.</p>
</blockquote>
<pre><code>    ReceivedMessage = @Event.Data.Message;
    ReceivedData = @Event.Data.Data;
</code></pre>
<ul>
<li><strong>The message object</strong><br>
Messages are sent between Workbooks using a fixed format message object. The message object has 5 properties, which specify the receiver address and the message contents. If you do not specify an address, the message is broadcasted to all Workbooks running on the same website.
The message object is set up by calling the <a href="../instructions/configuremessage.html">ConfigureMessage(…)</a> function.</li>
</ul>
<p><strong>Message Object Properties</strong></p>
<p><code>ToWorkbookId</code><br>
<em>Data Type : string.</em><br>
To send a message to a specific Workbook, you need to assign the metadata id of the target Workbook to this property. The metadata id of the target Workbook can be found by right-clicking the Workbook in the Solution Explorer and selecting «Copy to Clipboard».</p>
<p><code>ToUserName</code><br>
<em>Data Type : string.</em><br>
To send a message to a specific user, you need to assign the user id of the receiver to this property, for example <em>hypotesia\bg</em>.</p>
<p><code>MessageCode</code><br>
<em>Data Type : string.</em><br>
This property is is part of the message contents and can be used to specify the content type of message category.</p>
<p><code>Message</code><br>
<em>Data Type : string.</em><br>
This property is part of the message content and is used for specifying the actual message being passed. Note that the data type of the property is text, so if you want to send a value not being a text, you need to use the Data property.</p>
<p><code>Data</code><br>
<em>Data Type : Any.</em><br>
This property is part of the message content and is used for passing arbitrary data with the message.</p>
<hr>
<p><strong>Creating and sending a message object</strong></p>
<p>Message are sent by executing a SendMessage Action and calling the ConfigureMessage function to specify the message receiver and payload.</p>
<blockquote>
<p><strong>Example</strong></p>
<p>This example shows how to send a message by specifying the receiving Workbook and the message contents.<br>
The SendMessage Action is found in the list of available actions of the Workbook.</p>
</blockquote>
<pre><code>    ConfigureMessage(&quot;xx123&quot;, null,&quot;Code_123&quot;,&quot;Hello World&quot;, 1000.5);
</code></pre>
<blockquote>
<p>Using the ConfigureMessage function, we provided the following arguments:<br>
Receiver workbook : xxx123<br>
Receiving user : null (everyone)<br>
Message code : Code_123<br>
Message : Hello world<br>
Data : 1000.5</p>
</blockquote>
<p><strong>Using variables</strong></p>
<p>When creating a message object, you can assign values to the properties from variables.</p>
<blockquote>
<p><strong>Example</strong></p>
<p>This example shows how to create a message object and compile the message using the builtin system variable CurrentUserName and the CONCAT function.</p>
</blockquote>
<pre><code>    ConfigureMessage(&quot;xx123&quot;,null, &quot;Code_123&quot;,  
    CONCAT(&quot;Hello World from &quot;, SYS.CurrentUserName), 1000.5);
</code></pre>
<br>
<h3 id="videos">Videos</h3>
<ul>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/Workbook%20Interactions%20-%20Sending%20Messages%20Between%20Workbooks.mp4">Sending Messages Between Workbooks</a></li>
</ul>
</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>