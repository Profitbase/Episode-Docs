<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Table View | Profitbase Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Table View | Profitbase Docs ">
      
      <link rel="icon" href="../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../public/main.css">
      <meta name="docfx:navrel" content="../../../toc.html">
      <meta name="docfx:tocrel" content="../../../toc.html">
      
      <meta name="docfx:rel" content="../../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
  </head>

  <script type="module">
    import options from './../../../public/main.js'
    import { init } from './../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../index.html">
            <img id="logo" class="svg" src="../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h3 id="table-view">Table View</h3>

<p>Table View is used for displaying data in a read-only data grid. Compared to spreadsheet <a href="tables.html">tables</a> (<a href="worksheets.html">Worksheet</a>, Table, and <a href="sqlreports.html">SQL Report</a>) which is used for editing data, Table View is used for displaying data in a user-friendly and nicely formatted way. The component has built-in features for selection, sorting, filtering, formatting, and custom renderers.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/TbView1.png" alt="TbV"></p>
<h3 id="data">Data</h3>
<p>Use a SQL query to define the data set that is displayed in a Table View. You can load data from any database table or view it in the Solution database. To enable access control, use filters that reference dimensions using the same syntax that you are using to create SQL Reports.</p>
<p>You can also use macros to create highly dynamic queries using C#.</p>
<br>
<h3 id="data-grid-layout-and-behavior">Data Grid layout and behavior</h3>
<p>The Data Grid tab in the Table View designer is where you create the layout and behavior by adding columns from the data set and setting properties for selection, paging, and filtering.</p>
<p>Before you can create the layout, run the (Data Source) SQL query so that you can easily add columns to the data grid from the data set.
<br></p>
<p><strong>Columns</strong></p>
<blockquote>
<p>To configure a column, select it from the Columns list and edit its properties in the Properties window.</p>
</blockquote>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/dtgrid.png" alt="pic"></p>
<h3 id="how-to-create-dynamic-and-localized-column-captions">How to create dynamic and localized column captions</h3>
<p>If you need a dynamic column caption, or you need to support localization, use the <strong>Caption Expression</strong> to create a C# expression that returns a string.
<br></p>
<p><strong>Example</strong></p>
<blockquote>
<p>This caption expression translates the text associated with the &quot;AccountID&quot; text code to the language of the currently logged-in user:</p>
</blockquote>
<pre><code>Localize(&quot;AccountID&quot;)
</code></pre>
<br>
<h3 id="how-to-render-the-custom-cell-content">How to render the custom cell content</h3>
<p>Use the Renderer column property to define a JavaScript function that returns the HTML element to render in the cell.</p>
<br>
<p><strong>Example</strong></p>
<blockquote>
<p>This example shows how to use a custom renderer to render a SVG into a cell:</p>
</blockquote>
<pre><code>function(eventArgs, services){
    const importancePct = (eventArgs.value / 10) * 100;
    const svg = document.createElementNS(&quot;http://www.w3.org/2000/svg&quot;, &quot;svg&quot;);
    svg.setAttribute(&quot;width&quot;, &quot;100%&quot;);
    svg.setAttribute(&quot;height&quot;, &quot;30px&quot;);

    const newRect = document.createElementNS(&quot;http://www.w3.org/2000/svg&quot;, &quot;rect&quot;);
    newRect.setAttribute(&quot;width&quot;, importancePct + '%');
    newRect.setAttribute(&quot;height&quot;, &quot;100%&quot;);
    newRect.setAttribute(&quot;fill&quot;, importancePct &gt; 50 ? 'green' : 'yellow');
    svg.appendChild(newRect);

    return svg;
}
</code></pre>
<br>
<h3 id="how-to-format-cells">How to format cells</h3>
<p>You can format numeric and date/datetime cells using the <strong>Format String</strong> or <strong>Formatter</strong> property.
<br></p>
<h3 id="how-to-define-context-menu-actions">How to define context menu actions</h3>
<p>You can define custom actions pr column that the user can execute. Custom actions are defined with the <strong>Context Menu Actions</strong> property.</p>
<p>When a user executes an action, the action can be acted upon in the Workbook by handling the &quot;Custom Context Menu Action executed&quot; event of the Table View component. In the event handler, you can access the following properties of the **@Event** object.
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/TbView2.png" alt="TbV"></p>
<br>
<pre><code>{
  Data: {}, // the row object of the cell that was clicked
  Selection:{
    Rows: [{
      Columns: [], // array of column names of the row (keys)
      RowData: {ColumnName: cellValue, ...} // each key and value of the row
    }], // All the selected rows
    Cells: [{ RowData: &quot;cell value&quot;, Column: &quot;name of the column&quot;}, ... ] // All the selected cells
  },
  Sender:{
    ActionName: &quot;the name of the context menu action that was executed&quot;,
    ColumnName: &quot;the name of the column&quot;
  }
}
</code></pre>
<br>
<h3 id="how-to-filter-on-one-or-more-columns">How to filter on one or more columns</h3>
<p>To enable filtering on one or more columns, set the <strong>Enable filter</strong> property to the true for each column that you want to filter on. This will add a filtering option for the column to the filter bar at the top of the Table View component in the Workbook.</p>
<p>The filter options for a column are based on its data type. For example, a numeric column can be filtered using numeric operators such as less than or greater than, while a text column can be filtered by equals, contains, starts with, and so on.
If you want to instead enable the user to pick from a list of values in the column, use the <strong>Filter Type</strong> property and switch from <strong>Default</strong> to <strong>Select</strong>.</p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/enableFil.png" alt="pic">
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/enableFil1.png" alt="pic">
<br></p>
<h3 id="how-to-use-row-selectability">How to use row selectability</h3>
<br>
<p>Developers can write JavaScript that evaluates whether or not specific rows are selectable by the user in TableView components. That provides developers fine-grained control over whether or not a row can be selected by a user based on business logic and application state.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/tbVsel%20(1).png" alt="pic"></p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/tbVsel%20(2).png" alt="pic"></p>
<br>
<p><strong>Example</strong></p>
<p>This function will return true if the value of <strong>args.row.Ratings</strong> is greater than or equal to <strong>8</strong>, which means that the row will be selectable if the ratings are equal to or higher than 8.:</p>
<pre><code>function (args: {rows: any[], row: any, variables: {[index: string]: any}}): boolean {
  return (args.row.Ratings &gt;= 8);
}
</code></pre>
<br>
<h3 id="rerender">Rerender</h3>
<br>
<p>The Table View can be re-rendered manually at any time. A typical use case for when you want to trigger a re-render is when some application state outside the TableView has changed, and you want this state to be reflected in the TableView.</p>
<p>This functionality is intended for controls that do not automatically refresh the TableView.</p>
<div class="NOTE">
<h5>Note</h5>
<p>This re-rendering process does not involve reloading data from the backend, but rather only involves the TableView re-rendering itself on the client-side.</p>
</div>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/tbVrerekumkum.png" alt="pic"></p>
<br>
<p>This action can be called in the interaction window of the control.</p>
<br>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/tbVrerekumkum1.png" alt="pic"></p>
<br>
<h3 id="how-to-pin-columns-to-left-or-right">How to pin columns to left or right</h3>
<p>You can pin columns to left or right using the <strong>Fixed State</strong> property.</p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/tbvFs.png" alt="pic"></p>
<br>
<h3 id="how-to-declare-filter">How to declare filter</h3>
<p>You can filter table view using <a href="filters/howto/hierarchicalfilter.html">hierarchical filter</a>, to do that you need to declare that filter in the load query. You will find more <a href="sqlreports/dataqueries.html">here</a> in <a href="sqlreports/dataqueries.html">Data Queries</a> subject, and in this <a href="tableview/howto/filter.html">example</a>.</p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/declare%20filter.png" alt="pic"></p>
<br>
<h3 id="how-to-enable-excel-export">How to enable excel export</h3>
<p>You can enable excel export, to do that you need to check &quot;enable excel export&quot; box and insert code template in the EXCEL EXPORT tab.
<br></p>
<p><img src="https://profitbasedocs.blob.core.windows.net/images/ExExTbv.png" alt="pic"></p>
<br>
<p>When you click the <strong>&quot;C#  Insert Code Template&quot;</strong>, it will be inserted.</p>
<pre><code>//This method is call for every header cell
public override ExcelExportHeaderCellOutput RenderHeaderCell(ExcelExportRenderHeaderCellInput input)
{
    //input.RowIndex (int)
    //input.ColumnIndex (int)
    //input.Caption (string)

    var output = CreateExcelExportHeaderCellOutput(input);
    //output.Caption (string)
    //output.ColumnSpan (string)
    //output.Font.Bold (bool)
    //output.Font.Italic (bool)
    //output.Font.Size (bool)
    //output.HorizontalAlignment (string - 'left' | 'right' | 'center')

    output.Font.Bold = true;

    return output;
}

//This method is called for every data cell
public override ExcelExportDataCellOutput RenderDataCell(ExcelExportRenderDataCellInput input)
{
    //input.RowIndex (int)
    //input.ColumnIndex (int)
    //input.Value (string)
    //input.Row (DataRow)
    //input.Column (DataColumn)

    var output = CreateExcelExportDataCellOutput(input);
    //output.RowIndex = input.RowIndex;
    //output.ColumnIndex = input.ColumnIndex;
    //output.Value = input.Value;
    //output.FormatString (string)
    //output.Font.Bold (bool)
    //output.Font.Italic (bool)
    //output.Font.Size (bool)
    //output.HorizontalAlignment (string - 'Left' | 'Right' | 'Center')

    output.HorizontalAlignment = &quot;Right&quot;;

    return output;
}
</code></pre>
<br>
<h3 id="videos">Videos</h3>
<ul>
<li><a href="../videos/tableview.html">Table View</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/Table%20View%20-%20Basics.mp4">Table View - Basics</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/Table%20View%20-%20Macro%20Expansion.mp4">Table View - Macro Expansion</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/Table%20View%20-%20Custom%20Cell%20Renderer.mp4">Table View -Custom Cell Renderer</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/Table%20View%20-%20Declaring%20Filter.mp4">Table View - Declaring Filter</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/Table%20View%20-%20enable%20excel%20export.mp4">Table View - Enable Excel Export</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/TBV%20-%20Row%20Selectability%20Condition.mp4">Table View - Row Selectability Condition</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/TBV%20-%20rerender.mp4">Table View - Rerender</a></li>
</ul>
</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>