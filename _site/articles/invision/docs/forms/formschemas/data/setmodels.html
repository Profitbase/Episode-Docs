<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Set Models | InVision </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Set Models | InVision ">
      
      <link rel="icon" href="../../../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../../">
      
      
      
  </head>

  <script type="module">
    import options from './../../../../../../public/main.js'
    import { init } from './../../../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">


<p>Set Models are similar to Lists, except their contents can be modified and saved back to the database. Set Models represents a collection of objects which is read from the database, can be modified in the user interface, and then saved back to the database. You would typically use a Set Model for displaying and editing data in a Listbox.</p>
<p><strong>Example</strong></p>
<p>This example shows how to load all employees in a department and display them in a Listbox.</p>
<pre><code class="lang-xml">&lt;SetModels&gt;
        &lt;SetModel Name=&quot;Employees&quot;
        Source=&quot;Employees_ByDepartment&quot;
        Fields=&quot;EmpID, FirstName, LastName&quot;
        Filter=&quot;DepID = @DepID&quot;
        ItemKey=&quot;EmpID = @EmpID&quot;&gt;
        &lt;/SetModel&gt;
&lt;/SetModels&gt;

...
&lt;Listbox Row=&quot;12&quot; Column=&quot;1&quot; ColumnSpan=&quot;2&quot; ItemsSource=&quot;Employees&quot; KeyProp=&quot;EmpID&quot;&gt;
    &lt;ItemTemplate&gt;
        &lt;Layout Grid=&quot;listboxItemTemplateGrid&quot; CssClass=&quot;listbox-item&quot;&gt;
            &lt;Label Row=&quot;1&quot; Column=&quot;1&quot; Text=&quot;{Binding Path:FirstName}&quot;/&gt;
            &lt;Input Row=&quot;1&quot; Column=&quot;2&quot; Value=&quot;{Binding Path:LastName}&quot; Type=&quot;text&quot; /&gt;
            &lt;Button Row=&quot;2&quot; Column=&quot;1&quot; Text=&quot;Edit&quot; Click=&quot;EditEmp($Data)&quot; /&gt;
        &lt;/Layout&gt;
    &lt;/ItemTemplate&gt;
&lt;/Listbox&gt;
</code></pre>
<hr>
<h3 id="set-model-properties">Set Model Properties:</h3>
<br>
<h4 id="name">Name</h4>
<p>The name of the model. <strong>Required</strong>.</p>
<br>
<h4 id="source">Source</h4>
<p>The database object to read from. Source can either be a View, Table or @Object[…].DbObjectName reference. <strong>Required unless LoadQuery is specified.</strong></p>
<br>
<h4 id="fields">Fields</h4>
<p>Specifies the members of the Model, and the columns containing the data for the model. <strong>Required unless SaveQuery is specified.</strong>.</p>
<br>
<h4 id="filter">Filter</h4>
<p>Specifies the WHERE clause. This property is ignored if the LoadQuery is specified. <strong>Optional</strong>.</p>
<br>
<h4 id="itemkey">ItemKey</h4>
<p>Specifies the WHERE clause that identifies a single row in the set. This property is used when data is saved to the database. <strong>Required</strong> if you want to save data.</p>
<br>
<h4 id="insertkey">InsertKey</h4>
<p>When a Set Model is saved, it will either do an Update or Insert pr row, based on whether the row mathing a key exists or not. The InsertKey is a comma separated list of tokens that specifies the mapping between parameters and key columns not already contained in the Fields property, that is required to insert a new row. The insert key must be on the form **Column1 = @Param1, Column2 = @Param2, ... **</p>
<br>
<p><strong>Example</strong></p>
<pre><code class="lang-xml">&lt;SetModel InsertKey=&quot;ProductID = @ProductID, Year = @Year&quot;/&gt;
</code></pre>
<br>
<h4 id="autoinsert">AutoInsert</h4>
<p>When saving Set Model data, and no custom SaveQuery is specified, InVision will do an update for each Set Model object if a matching row already exist, or an Insert if no matching row exist. If, for some reason, you don’t want an insert to happen, you need to explicitly set this property to false. <strong>Optional</strong>. The default value is true.</p>
<h4 id="savequery">SaveQuery</h4>
<p>If data is not to be saved to the source table, or if you need to use a custom SQL to save the data correctly, you need to provide the query manually. The SaveQuery executes pr Set Model item. <strong>Optional.</strong></p>
<br>
<p><strong>Example</strong></p>
<pre><code class="lang-xml">&lt;SetModel&gt;
    &lt;SaveQuery&gt;
        UPDATE Table1 SET CustomerID = @CustomerID, etc
    &lt;/SaveQuery&gt;
&lt;/SetModel&gt;
</code></pre>
<br>
<h4 id="loadquery">LoadQuery</h4>
<p>Use the load query if you want to provide a custom query for loading items into the Set Model. For example, if you need to pull in data from multiple tables, or if you need to apply transformation during load. <strong>Optional.</strong></p>
<br>
<p><strong>Example</strong></p>
<pre><code class="lang-xml">&lt;SetModel&gt;
    &lt;LoadQuery&gt; SELECT CustomerID, CustomerName FROM  &lt;/LoadQuery&gt;
&lt;/SetModel&gt;
</code></pre>
<h4 id="connectionstring">ConnectionString</h4>
<p>If the source table is not in the InVision database, you need to specify the connection string. <strong>Optional.</strong></p>
<br>
<h3 id="videos">Videos</h3>
<ul>
<li><a href="../../../../videos/formschemas.html">Form Schemas</a></li>
<li><a href="https://profitbasedocs.blob.core.windows.net/videos/FormSchema-Listbox-Basics.mp4">Listbox - Basics</a></li>
</ul>
</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>