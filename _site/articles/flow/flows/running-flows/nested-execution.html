<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Running Flows within Flows | Profitbase Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Running Flows within Flows | Profitbase Docs ">
      
      <link rel="icon" href="../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../public/main.css">
      <meta name="docfx:navrel" content="../../../../toc.html">
      <meta name="docfx:tocrel" content="../../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
  </head>

  <script type="module">
    import options from './../../../../public/main.js'
    import { init } from './../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../index.html">
            <img id="logo" class="svg" src="../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="running-flows-within-flows">Running Flows within Flows</h1>

<p>To run a Flow within another Flow, use the <a href="../../actions/built-in/run-flow.html">Run Flow</a> action.</p>
<br>
<p><img src="../../../../images/running4.png" alt="img"></p>
<h2 id="input">Input</h2>
<p>If the Flow you want to run supports parameterization, you can specify an argument to pass to the Flow. All Flows technically accepts a single argument, but it's up to the implementer to decide whether to use that data or not. It is also up to the implementer to decide the format of the input data. It can be anything from a simple numeric value to a complex business object. To know the type and format of the data you can pass in, you need to open the Flow you want to run and examine its configuration. If the Flow is implemented following best practices, it should have a <a href="../../triggers/flow-trigger.html">Flow trigger</a> which optionally defines the parameter type definition.</p>
<h2 id="return-data">Return data</h2>
<p>If the Flow you want to run returns data, you can use the data returned as input to actions later in the Flow. Note, however, that the data returned is typed as <a href="https://learn.microsoft.com/en-us/dotnet/api/system.object">System.Object</a>, so you almost always have to convert it to a type known by the calling Flow before you can use as input to other actions.</p>
<p>To convert the returned value to a format that can be used by actions in the calling Flow, specify the <code>Output data type</code> property of the <a href="../../actions/built-in/run-flow.html">Run Flow</a> action in the <code>Properties</code> panel.</p>
<h3 id="example">Example</h3>
<p>This example demonstrates how to run a Flow within another Flow. We will call them <code>Order processor</code> and <code>Create order</code>, respectively.
<code>Order processor</code> will pass a list of shopping cart items to <code>Create order</code>, which in turn will return an Order object back to <code>Order processor</code>.</p>
<h4 id="outline">Outline</h4>
<ol>
<li><code>Order processor</code> calls <code>Create order</code> using the <a href="../../actions/built-in/run-flow.html">Run Flow action</a>, and passes in an order request coming from an HTTP request via an <a href="../../triggers/http-trigger.html">HTTP Trigger</a>.</li>
<li><code>Create order</code> has a <a href="../../triggers/flow-trigger.html">Flow trigger</a> which converts the input from <code>Order processor</code> to a list of shopping cart items.</li>
<li><code>Create order</code> processes the items and returns an Order object to <code>Order processor</code> using the <a href="../../actions/built-in/return.html">Return action</a></li>
<li><code>Order processor</code> converts the Order object returned from <code>Create order</code> to its own object so it can be used by other actions in the Flow.</li>
</ol>
<h4 id="step-by-step">Step-by-step</h4>
<h5 id="configure-the-create-order-flow">Configure the Create order Flow</h5>
<ol>
<li><p>Create a Flow named <code>Create order</code>.</p>
</li>
<li><p>In <code>Create order</code>, create a <a href="../../triggers/flow-trigger.html">Flow trigger</a> to define the entry point of the Flow, and the format of the data that <code>Create order</code> accepts as input from <code>Order processor</code>.</p>
</li>
<li><p>Select the Flow trigger, toggle <code>Output data type</code> to <code>Use custom type(s)</code>, and open the data type editor in the <code>Properties</code> panel. Define the following data format:<br>
<img src="../../../../images/nested_execution_example_create_order_datatype.png" alt="img"></p>
</li>
<li><p>Define the business logic to process the shopping cart items. As this is beyond the scope of this example, we will not go into details on these steps. A quick-and-dirty implementation would be to simply insert data to a database. The image below shows a series of steps to create an order id, create order lines and save them to a SQL Server database.
<br></p>
</li>
</ol>
<p><img src="/images/nested_execution_example_insert_to_db.png" alt="img"></p>
<br>
<ol start="4">
<li>The final steps of <code>Create order</code> is to return the Order object so it can be used by the caller.
To do this, you can either add a <a href="../../actions/built-in/define-type.html">Define Type</a> action or define the the Order object using <a href="../defining-custom-code.html">custom code</a>. We've chosen to use custom code in this example.</li>
</ol>
<br>
<p><img src="/images/nested_execution_example_order_custom_code.png" alt="img"></p>
<br>
<p>Next, use a <a href="../../actions/built-in/function.html">Function</a> action to create an instance of Order and use the <a href="../../actions/built-in/return.html">Return</a> action to return Order from <code>Create order</code>.</p>
<p><img src="/images/nested_execution_example_return_order.png" alt="img"></p>
<br>
<h5 id="configure-the-order-processor-flow">Configure the Order processor Flow</h5>
<p><code>Order processor</code> will call <code>Create order</code> by passing in an order request and get back the Order.</p>
<ol>
<li>Create a <a href="../../triggers/http-trigger.html">HTTP Trigger</a> and define the input. This is the order request that we will pass directly to <code>Create order</code>.
Select the HTTP Trigger and define the input from the <code>Data definition</code> property in the <code>Property panel</code>. It should look exactly like the data definition we created in <code>Step 3</code> of the <code>Create order</code> Flow above.</li>
</ol>
<br>
<p><img src="/images/nested_execution_example_create_order_request_datatype.png" alt="img"></p>
<ol start="2">
<li>Add a <a href="../../actions/built-in/run-flow.html">Run Flow action</a>. In the <code>Properties panel</code>, select <code>Create order</code> as the Flow to run, and select the data variable from the HTTP Trigger as input. It should look similar to this:
<br></li>
</ol>
<p><img src="/images/nested_execution_example_run_create_order.png" alt="img"></p>
<ol start="3">
<li>With the Run Flow action still selected, use the <code>Output data type</code> property in the <code>Properties panel</code> to define the format of the Order object returned from <code>Create order</code>. By defining the format of the object, you tell Flow how to handle the data returned from the other Flow and convert it into something that can be used on the receivng end.</li>
</ol>
<p>From <code>Step 4 </code> of the <code>Create order</code> Flow above, we remember that the format of the object was</p>
<pre><code class="lang-csharp">public record Order(string OrderId)
</code></pre>
<h5 id="summary">Summary</h5>
<p>To summarize how to run a Flow in another Flow, you need to use the <a href="../../actions/built-in/run-flow.html">Run Flow</a> action.
If you want to exchange data between the Flows using custom business objects, you need to define the formats of the data you want to exchange on both sides.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Note that you only need to define data formats if you want to pass custom business objects between the Flows. If you only want to pass data back and forth  using standard .NET types such as strings, numbers, dates etc, you can simply select the standard type to use in the <code>Output data type</code> property.</p>
</div>
</article>

        <div class="contribution d-print-none">
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>