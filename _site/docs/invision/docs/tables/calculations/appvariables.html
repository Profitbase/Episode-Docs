<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>AppVariables in Formulas | Profitbase Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="AppVariables in Formulas | Profitbase Docs ">
      
      <link rel="icon" href="../../../../../images/favicon.ico">
      <link rel="stylesheet" href="../../../../../public/docfx.min.css">
      <link rel="stylesheet" href="../../../../../public/main.css">
      <meta name="docfx:navrel" content="">
      <meta name="docfx:tocrel" content="../../../toc.html">
      
      <meta name="docfx:rel" content="../../../../../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
  </head>

  <script type="module">
    import options from './../../../../../public/main.js'
    import { init } from './../../../../../public/docfx.min.js'
    init(options)
  </script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../../../../index.html">
            <img id="logo" class="svg" src="../../../../../images/logo.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">


<p>AppVariables enable you to use Workbook variables in spreadsheet formulas. This is useful if you have some constant or other value that is set outside the spreadsheet that you want to use in your formulas.</p>
<p>You can read the value of a Workbook variable by calling AppVariables.getValue(&quot;variable name&quot;) or reading the value directly as a property from the AppVariables object : AppVariables.TheVariable.</p>
<blockquote>
<p><strong>Example</strong></p>
<p>Suppose you have assigned a value to the variable Factor in your workbook, you can get the value of Factor in your formula like this:</p>
</blockquote>
<pre><code>@Amount[] = @TotalForce[] * AppVariables.getValue(&quot;Factor&quot;);
</code></pre>
<blockquote>
<p>or</p>
</blockquote>
<pre><code>@Amount[] = @TotalForce[] * AppVariables.Factor
</code></pre>
<p><strong>AppVariables.getValue(&quot;X&quot;) vs AppVariables.X</strong></p>
<p>You need use the getValue(…) function rather than accessing the property if your variable name contains white spaces.</p>
<p>For example, if your variable is called   @Var[My Variable], using AppVariables.@Var[My Variable] will not work because a property name cannot contain whitespace and [] characthers. Instead, you would need to use AppVariables.getValue(&quot;@Var[My Variable]&quot;);</p>
<p><strong>Executing formulas after an AppVariable has been changed</strong></p>
<p>If you modify an AppVariable outside of a Worksheet or Setting, (for example from a Form Element), and that AppVariable is used in a formula, you need to invoke the RecalcAction of the Worksheet of Setting.
For example, if you're entering some value into a Form element, and you want to trigger a recalc based on the new value, you need to execute the <strong>RecalcAction</strong> from the <strong>SelectionChanged</strong> event of the Form Element.</p>
</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>
        
      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>