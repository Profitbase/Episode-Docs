---
title: "How To Automate PowerShell Script with Data Flow"
metaKeys: "How To get All File Names From a File Storage"
folderOnly: "false"
pageIndex: 1
---



### Link to the video

Under [this link](https://profitbasedocs.blob.core.windows.net/videos/PowerShell%20-%20How%20To%20Automate%20Script%20with%20Data%20Flow.mp4) you will find video that shows How To Automate PowerShell Script with [Data Flow](../../dataflows.md). [Here](../commands.md) you will find [Documentation about used command](../commands.md).
<br/>


### Step by step


1. Right-click chosen folder in Solution Explorer to add a new item, choose Data Flow and Data Flow Iem:

![pic](https://profitbasedocs.blob.core.windows.net/images/PSiDFht%20(1).png)

2. Choose Run PowerShell Script from the templates in the toolbox and set up the Data Flow Item:

![pic](https://profitbasedocs.blob.core.windows.net/images/PSiDFht%20(2).png)

3. Set up parameters:

![pic](https://profitbasedocs.blob.core.windows.net/images/PSiDFht%20(3).png)

4. Define the _state variable in the Workbook interactions:

![pic](https://profitbasedocs.blob.core.windows.net/images/PSiDFht%20(4).png)

5. Set up Upload Completed event for the File Storage:

![pic](https://profitbasedocs.blob.core.windows.net/images/PSiDFht%20(5).png)

6. Set up Data Flow Arguments:

![pic](https://profitbasedocs.blob.core.windows.net/images/PSiDFht%20(6).png)


<br/>